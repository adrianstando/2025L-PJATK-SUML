trigger:
  branches:
    include:
      - main

pool:
  vmImage: 'ubuntu-latest'

jobs:
- job: build_and_deploy_app_demo
  displayName: 'Build and Deploy App Demo'
  steps:
  
  - checkout: self
    displayName: 'ğŸ§¾ Checkout repo'

  - task: UsePythonVersion@0
    displayName: 'ğŸ Setup Python'
    inputs:
      versionSpec: '3.10'
      addToPath: true

  - script: |
      echo "Installing dependencies..."
      # python -m pip install --upgrade pip
      # pip install -r requirements.txt
    workingDirectory: ./02-environment/sentiment_analysis
    displayName: 'ğŸ“¦ Install dependencies'

  - script: |
      echo "Building Docker image..."
      # docker build -t myapp:latest .
    workingDirectory: ./04-docker/example
    displayName: 'ğŸ› ï¸ Build Docker image'

  - script: |
      echo "Pushing Docker image..."
      # docker login
      # docker push myregistry/myapp:latest
    workingDirectory: ./04-docker/example
    displayName: 'ğŸ³ Push Docker image'

  - script: echo "Deploying myapp:latest to PROD..."
    displayName: 'ğŸš€ Deploy to production'
